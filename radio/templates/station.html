{% extends "base.html" %}

{% load render_bundle from webpack_loader %}
{% load staticfiles %}

{% block content %}

<div class="row">

<div class="col">
    Status: <span id="connection-status" class="bg-info">Not Connected</span><br>
    <span id="connection-status-error" class="bg-danger"></span><br>

    <div>
        <h1 id="station-name"></h1>
        <div id="album-art"></div>
        <span id="playback-track-title"></span><br>
        <span id="playback-track-artist"></span><br>
        <span id="playback-current-position">0:00</span>/<span id="playback-duration">0:00</span>
    </div>

    <div id="listener-controls">
        <button id="mute-button" class="btn" type="submit" aria-pressed="false">
            <i class="fas fa-volume-up"></i>
        </button>

        <input id="volume-slider" type="range" min="0" max="1" step="0.1" />
    </div>

    <div id="dj-controls">
        <button id="previous-track-button" class="btn" type="submit" aria-pressed="false" disabled="true">
            <i class="fas fa-step-backward"></i>
        </button>

        <button id="play-pause-button" class="btn" type="submit" aria-pressed="false" disabled="true">
            <i class="fas fa-play"></i>
        </button>

        <button id="next-track-button" class="btn" type="submit" aria-pressed="false" disabled="true">
            <i class="fas fa-step-forward"></i>
        </button>
    </div>
</div>
<div id="admin-view" class="col">
    <div>
        <h2>Listeners</h2>
        <table id="listeners-table" class="table table-striped"></table>
    </div>
    <div>
        <h3>Invite listeners</h3>
        <form id="invite-listener-form" class="form-inline">
            <input type="email" class="form-control form-control-sm" id="invite-listener-email" placeholder="name@example.com" disabled="true">
            <button type="submit" class="btn btn-primary btn-sm" disabled="true">Send invite</button>
        </form>
        <span id="admin-invite-sent"></span>
        <table id="pending-listeners-table" class="table table-striped"></table>
    </div>
</div>
</div>

{% endblock %}{# content #}

{% block extra_script %}
<script src="https://sdk.scdn.co/spotify-player.js"></script>
<script src="{% static 'channels/js/websocketbridge.js' %}"></script>
<script>
    'use strict';
    const APP_DATA = {
        spotifyConnectPlayerName: '{{ player_name }}',
        userIsDJ: {{ is_dj|yesno:"true,false" }},
        userIsAdmin: {{ is_admin|yesno:"true,false" }},
        accessToken: "{{ access_token }}",
        stationId: {{ station_id }},
    };
</script>

{% render_bundle 'station' %}

{% endblock %}{# extra_script #}
